webpackJsonp([1],{0:function(e,t){},"46AY":function(e,t){},"8aYd":function(e,t){},CNBC:function(e,t){},FBEZ:function(e,t){},Gsgj:function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("7+uW"),r={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]},o=n("VU/8")({name:"App"},r,!1,null,null,null).exports,s=n("/ocq"),i=n("Xxa5"),l=n.n(i),c=n("exGp"),u=n.n(c),d=n("ifoU"),p=n.n(d),m=n("E5Az"),b={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"conversation-item-menu box-shadow1"},[n("span",{staticClass:"menu-item operation-text",on:{click:function(t){return t.stopPropagation(),e.remove.apply(null,arguments)}}},[e._v("编辑")]),e._v(" "),n("el-popover",{attrs:{placement:"top",width:"160"},model:{value:e.showDelPop,callback:function(t){e.showDelPop=t},expression:"showDelPop"}},[n("p",[e._v("是否确定删除？")]),e._v(" "),n("div",{staticStyle:{"text-align":"right",margin:"0"}},[n("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){e.showDelPop=!1}}},[e._v("取消")]),e._v(" "),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.deleteConversation.apply(null,arguments)}}},[e._v("确定")])],1),e._v(" "),n("span",{staticClass:"menu-item operation-text",attrs:{slot:"reference"},on:{click:function(e){return e.stopPropagation(),function(){}.apply(null,arguments)}},slot:"reference"},[e._v("删除")])])],1)},staticRenderFns:[]};var f=n("VU/8")({name:"HomeMenu",props:["conversation"],data:function(){return{showDelPop:!1,friendInfo:{}}},computed:{userInfo:function(){return this.$store.state.user.userInfo}},methods:{remove:function(){this.$emit("hiddenMenu",this.conversation,"edit")},deleteConversation:function(){this.$emit("hiddenMenu",this.conversation,"remove")}}},b,!1,function(e){n("nIhj")},null,null).exports,h=n("//Fk"),v=n.n(h),g=n("Zrlr"),C=n.n(g),k=n("wxAW"),w=n.n(k),x=n("zL8q"),T=n.n(x),y=(n("mvHQ"),n("Av7u")),F=n.n(y);F.a.enc.Utf8.parse("1234567890123456"),F.a.enc.Utf8.parse("1234567890123456");var _=n("mtWM"),S=n.n(_),D=new(function(){function e(){var t=this;C()(this,e),this.axiosService=S.a.create({baseURL:"http://localhost:8083"}),this.addInterceptor(),this.axiosService.getRequest=function(e){return t.axiosService.get(e)}}return w()(e,[{key:"addInterceptor",value:function(){var e=null;this.axiosService.interceptors.request.use(function(t){e=a.default.prototype.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});var n=localStorage.getItem("token");return n&&(t.headers.authorization=n),t},function(e){return v.a.reject(e)}),this.axiosService.interceptors.response.use(function(t){return null!=e&&e.close(),t.data.success||void 0===t.data.success?t.data.data:(console.log(t),x.Message.error({message:t.data.message}),333===t.data.code&&((n="token")&&window.localStorage.removeItem(n),U.push({path:"/"})),334===t.data.code&&v.a.resolve(t),v.a.reject(t.data.message));var n},function(e){return x.Message.error({message:e}),v.a.reject(e)})}}]),e}()),M=D.axiosService,q=function(e){return M.post("/database/run-sql",e)},z={components:{codemirror:m.codemirror,homeMenu:f},props:["conversation"],created:function(){var e=this;document.addEventListener("click",function(){e.isShowMenu=!1}),document.addEventListener("mousedown",function(t){2===t.button&&(e.isShowMenu=!1)})},data:function(){return{showTableData:[],pageSize:10,currentPage:1,isShowMenu:!1,menuTop:0,menuLeft:0,props:{label:"name",children:"tables",isLeaf:"leaf"},cmOptions:{tabSize:30,mode:"text/x-sql   ",theme:"idea",lineNumbers:!0,line:!0,viewportMargin:1/0,highlightDifferences:!0,autofocus:!1,indentUnit:2,smartIndent:!0,readOnly:!1,showCursorWhenSelecting:!0,firstLineNumber:1,matchBrackets:!0,lineMapping:!0,styleActiveLine:!0,extraKeys:{Ctrl:"autocomplete"},hintOptions:{completeSingle:!1,tables:{users:["name","score","birthDate"],countries:["name","population","size"],score:["zooao"]}}},codeSnippets:"",editableTabsValue:"",editableTabs:[],tabIndex:0,connections:[],curClickConnection:{},curDbs:[],curTables:[],sqlContent:"",edittableTabsMap:new p.a,edittableTabsNameMap:new p.a,curClickTab:{},addConnDialog:!1,editConnDialog:!1,supportTypes:["MYSQL","ORACLE"],ruleForm:{name:"",dbType:"",host:"",loginUser:"",password:""},editConnForm:{},rules:{name:[{required:!0,message:"请输入连接名称",trigger:"blur"},{min:3,max:10,message:"长度在 3 到 10 个字符",trigger:"blur"}],dbType:[{required:!0,message:"请选择连接类型",trigger:"change"}],host:[{required:!0,message:"请填写主机地址",trigger:"blur"}],loginUser:[{required:!0,message:"请填写用户名",trigger:"blur"}],password:[{required:!0,message:"请填写密码",trigger:"blur"}]}}},mounted:function(){this.listTypes()},methods:{celldblclick:function(e,t){var n=function(t){t.clipboardData.setData("text/plain",e.label),t.preventDefault()};document.addEventListener("copy",n),document.execCommand("copy"),document.removeEventListener("copy",n),this.$message({message:"复制成功",type:"success"})},listTypes:function(){var e=this;return u()(l.a.mark(function t(){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,M.get("/database/list-types");case 2:e.supportTypes=t.sent;case 3:case"end":return t.stop()}},t,e)}))()},handleSizeChange:function(e){this.pageSize=e,this.handleCurrentChange(1)},handleCurrentChange:function(e){if(this.currentPage=e,this.curClickTab&&this.curClickTab.tableData)if(this.curClickTab.tableData.length<1)this.showTableData=[];else{var t=(e-1)*this.pageSize;this.showTableData=this.curClickTab.tableData.slice(t,t+this.pageSize)}else this.showTableData=[]},dbClick:function(e){var t=this;return u()(l.a.mark(function n(){var a;return l.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r=e,M.get("/database/list-tables/"+r.connId+"/"+r.database);case 2:a=n.sent,t.curTables=a;case 4:case"end":return n.stop()}var r},n,t)}))()},tableClick:function(e){var t=this;return u()(l.a.mark(function n(){var a,r,o,s;return l.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:a="select * from "+e.table+" limit 10",r=e.connId+"-"+e.database,null==(o=t.edittableTabsMap.get(r))?(s=++t.tabIndex+"",o={title:e.connName+"-"+e.database,name:s,sqlContent:a,database:e.database,connId:e.connId,tableData:[],tableMeta:[]},t.editableTabs.push(o),t.edittableTabsMap.set(r,o),t.edittableTabsNameMap.set(s,o),t.editableTabsValue=s):(o.sqlContent=a,t.editableTabsValue=o.name),t.curClickTab=o,t.doQuery(a,o);case 6:case"end":return n.stop()}},n,t)}))()},handleOpen:function(e){1==e&&this.queryConns()},executeSql:function(e,t,n){var a=this;return u()(l.a.mark(function r(){var o,s;return l.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return o={sql:e,connId:t,database:n},a.next=3,q(o);case 3:return s=a.sent,a.abrupt("return",s);case 5:case"end":return a.stop()}},r,a)}))()},listDbs:function(e){var t=this;return u()(l.a.mark(function n(){var a;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n=e,M.get("/database/list-dbs/"+n);case 2:return a=t.sent,t.abrupt("return",a);case 4:case"end":return t.stop()}var n},n,t)}))()},queryConns:function(){var e=this;return u()(l.a.mark(function t(){var n;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a=void 0,M.get("/database/list-conns",a);case 2:n=t.sent,e.connections=n;case 4:case"end":return t.stop()}var a},t,e)}))()},deletConn:function(e){var t=this;return u()(l.a.mark(function n(){return l.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,a=e,M.delete("/database/delete-conn/"+a);case 2:n.sent,t.queryConns();case 4:case"end":return n.stop()}var a},n,t)}))()},editUpdateConn:function(e){var t=this;return u()(l.a.mark(function n(){return l.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,a=e,M.post("/database/update-conn",a);case 2:n.sent,t.queryConns(),t.editConnDialog=!1;case 5:case"end":return n.stop()}var a},n,t)}))()},saveConn:function(e){var t=this;return u()(l.a.mark(function n(){return l.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,a=e,M.post("/database/save-conn",a);case 2:n.sent,t.queryConns(),t.addConnDialog=!1;case 5:case"end":return n.stop()}var a},n,t)}))()},refreshDb:function(e){var t=this;return u()(l.a.mark(function n(){var a;return l.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.listDbs(e);case 2:a=n.sent,t.curDbs=a;case 4:case"end":return n.stop()}},n,t)}))()},removeTab:function(e){var t=this,n=this.editableTabs,a=this.editableTabsValue;a===e&&n.forEach(function(r,o){if(r.name===e){var s=n[o+1]||n[o-1];s&&(a=s.name,t.curClickTab=s)}}),this.editableTabsValue=a;var r=null;this.editableTabs=n.filter(function(t){var n=t.name!==e;return n||(r=t.connId+"-"+t.database),n}),null!==r&&this.edittableTabsMap.delete(r),this.edittableTabsNameMap.delete(e)},clickTab:function(e){var t=this.edittableTabsNameMap.get(e.name);null!==t&&(this.curClickTab=t)},dbNodeClick:function(e){if(!0===e.leaf){var t="select * from "+e.name+" limit 10",n=e.connId+"-"+e.database,a=this.edittableTabsMap.get(n);if(null==a){var r=++this.tabIndex+"";a={title:e.connName+"-"+e.database,name:r,sqlContent:t,database:e.database,connId:e.connId,tableData:[],tableMeta:[]},this.editableTabs.push(a),this.edittableTabsMap.set(n,a),this.edittableTabsNameMap.set(r,a),this.editableTabsValue=r}else a.sqlContent=t,this.editableTabsValue=a.name;return this.curClickTab=a,void this.doQuery(t,a)}},runSql:function(){this.doQuery(this.curClickTab.sqlContent,this.curClickTab)},checkRunSql:function(){this.doQuery(window.getSelection().toString(),this.curClickTab)},doQuery:function(e,t){var n=this;return u()(l.a.mark(function a(){var r;return l.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,n.executeSql(e,t.connId,t.database);case 2:r=a.sent,t.tableMeta=r.tableMeta,t.tableData=r.tableData,n.handleCurrentChange(1);case 6:case"end":return a.stop()}},a,n)}))()},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){e&&t.saveConn(t.ruleForm)})},resetForm:function(e){this.$refs[e].resetFields()},showMenu:function(e){this.isShowMenu=!0,this.menuLeft=e.pageX,this.menuTop=e.pageY,this.curClickConnection=e},hiddenMenu:function(e,t){"edit"===t?(this.editConnForm=e,this.editConnDialog=!0):"remove"===t&&this.deletConn(e.id),this.isShowMenu=!1},submitUpdateForm:function(e){var t=this;this.$refs[e].validate(function(e){e&&t.editUpdateConn(t.editConnForm)})}}},I={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("div",[n("el-header",{staticStyle:{"text-align":"left","font-size":"12px","background-color":"white"}},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addConnDialog=!0}}},[e._v("\n                新建查询\n            ")])],1),e._v(" "),n("el-container",{staticStyle:{border:"1px solid #eee"}},[n("el-aside",{staticStyle:{"background-color":"rgb(238, 241, 246)"},attrs:{width:"200px"}},[n("el-menu",{staticStyle:{"background-color":"rgb(238, 241, 246)"},on:{open:e.handleOpen}},[n("el-submenu",{attrs:{index:"1"}},[n("template",{slot:"title"},[n("span",[e._v("我的连接")])]),e._v(" "),e._l(e.connections,function(t){return n("div",{key:t.id},[n("div",{on:{contextmenu:function(n){return n.preventDefault(),n.stopPropagation(),e.showMenu(t)}}},[n("el-menu-item",{attrs:{index:t.name},on:{click:function(n){return e.refreshDb(t.id)}}},[e._v("\n                                    "+e._s(t.name)+"\n                                ")])],1)])})],2)],1)],1),e._v(" "),n("el-aside",{attrs:{width:"300px"}},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.curDbs,border:""},on:{"cell-click":e.dbClick}},[n("el-table-column",{attrs:{prop:"database",label:"库"}})],1)],1),e._v(" "),n("el-aside",[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.curTables,border:""},on:{"cell-click":e.tableClick}},[n("el-table-column",{attrs:{prop:"table",label:"表"}})],1)],1),e._v(" "),e.editableTabs.length>0?n("el-container",[n("el-header",{staticStyle:{"text-align":"left","font-size":"12px"}},[n("el-button",{on:{click:e.runSql}},[e._v("运行")]),e._v(" "),n("el-button",{on:{click:e.checkRunSql}},[e._v("选中运行")])],1),e._v(" "),n("el-main",[n("el-tabs",{attrs:{type:"card",closable:""},on:{"tab-remove":e.removeTab,"tab-click":e.clickTab},model:{value:e.editableTabsValue,callback:function(t){e.editableTabsValue=t},expression:"editableTabsValue"}},[e._l(e.editableTabs,function(e,t){return n("el-tab-pane",{key:e.name,attrs:{label:e.title,name:e.name}})}),e._v(" "),n("codemirror",{attrs:{options:e.cmOptions},model:{value:e.curClickTab.sqlContent,callback:function(t){e.$set(e.curClickTab,"sqlContent",t)},expression:"curClickTab.sqlContent"}})],2),e._v(" "),n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.showTableData},on:{"header-click":e.celldblclick}},e._l(e.curClickTab.tableMeta,function(e){return n("el-table-column",{key:e.label,attrs:{prop:e.label,label:e.label,width:"180"}})}),1),e._v(" "),n("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,100,200,300,400],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.curClickTab.tableData.length},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1):e._e()],1)],1),e._v(" "),n("div",[n("el-dialog",{attrs:{title:"添加连接",visible:e.addConnDialog},on:{"update:visible":function(t){e.addConnDialog=t}}},[n("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[n("el-form-item",{attrs:{label:"连接名称",prop:"name"}},[n("el-input",{model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"连接类型",prop:"dbType"}},[n("el-select",{attrs:{placeholder:"请选择连接类型"},model:{value:e.ruleForm.dbType,callback:function(t){e.$set(e.ruleForm,"dbType",t)},expression:"ruleForm.dbType"}},e._l(e.supportTypes,function(e){return n("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1),e._v(" "),n("el-form-item",{attrs:{label:"主机",prop:"host"}},[n("el-input",{model:{value:e.ruleForm.host,callback:function(t){e.$set(e.ruleForm,"host",t)},expression:"ruleForm.host"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"用户",prop:"loginUser"}},[n("el-input",{model:{value:e.ruleForm.loginUser,callback:function(t){e.$set(e.ruleForm,"loginUser",t)},expression:"ruleForm.loginUser"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"密码",prop:"password"}},[n("el-input",{attrs:{type:"password"},model:{value:e.ruleForm.password,callback:function(t){e.$set(e.ruleForm,"password",t)},expression:"ruleForm.password"}})],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("立即创建")]),e._v(" "),n("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("重置")])],1)],1)],1)],1),e._v(" "),n("div",[n("el-dialog",{attrs:{title:"编辑连接",visible:e.editConnDialog},on:{"update:visible":function(t){e.editConnDialog=t}}},[n("el-form",{ref:"editConnForm",staticClass:"demo-ruleForm",attrs:{model:e.editConnForm,rules:e.rules,"label-width":"100px"}},[n("el-form-item",{attrs:{label:"连接名称",prop:"name"}},[n("el-input",{model:{value:e.editConnForm.name,callback:function(t){e.$set(e.editConnForm,"name",t)},expression:"editConnForm.name"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"连接类型",prop:"dbType"}},[n("el-select",{attrs:{placeholder:"请选择连接类型"},model:{value:e.editConnForm.dbType,callback:function(t){e.$set(e.editConnForm,"dbType",t)},expression:"editConnForm.dbType"}},e._l(e.supportTypes,function(e){return n("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1),e._v(" "),n("el-form-item",{attrs:{label:"主机",prop:"host"}},[n("el-input",{model:{value:e.editConnForm.host,callback:function(t){e.$set(e.editConnForm,"host",t)},expression:"editConnForm.host"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"用户",prop:"loginUser"}},[n("el-input",{model:{value:e.editConnForm.loginUser,callback:function(t){e.$set(e.editConnForm,"loginUser",t)},expression:"editConnForm.loginUser"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"密码",prop:"password"}},[n("el-input",{attrs:{type:"password"},model:{value:e.editConnForm.password,callback:function(t){e.$set(e.editConnForm,"password",t)},expression:"editConnForm.password"}})],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitUpdateForm("editConnForm")}}},[e._v("更新")])],1)],1)],1)],1),e._v(" "),e.isShowMenu?n("div",{staticClass:"menu",style:{left:e.menuLeft+"px",top:e.menuTop+"px"}},[n("div",{staticStyle:{width:"10%"}},[n("home-menu",{attrs:{conversation:e.curClickConnection},on:{hiddenMenu:e.hiddenMenu}})],1)]):e._e()])},staticRenderFns:[]};var $=n("VU/8")(z,I,!1,function(e){n("jcNX")},"data-v-139705ce",null).exports;a.default.use(s.a);var U=new s.a({routes:[{path:"/",name:"database",component:$,meta:{requiredAuth:!1}}]});n("tvR6"),n("8aYd"),n("46AY"),n("CNBC"),n("OzWN"),n("FBEZ"),n("wYHC"),n("VHDu"),n("W1jn"),n("D1j6"),n("vupN"),n("IM2z"),n("E2cS"),n("l5LD"),n("Buz9"),n("Ou4A"),n("Gsgj"),n("unjE"),n("QggT"),n("nxoM"),n("lcKf");window.jsonlint=n("D1j6"),a.default.use(m.codemirror),a.default.prototype.$axios=D.axiosService,a.default.prototype.$loading=x.Loading,a.default.use(T.a),new a.default({el:"#app",render:function(e){return e(o)},router:U,components:{App:o},template:"<App/>"})},OzWN:function(e,t){},jcNX:function(e,t){},nIhj:function(e,t){},tvR6:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.c9069da549c3d1cadd62.js.map